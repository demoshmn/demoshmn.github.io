<html>
<head>
<meta charset="utf-8"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<title> Test </title>
</head>
<body>
<div id="test" onclick="ClickRequestDeviceMotionEvent();">
Test iOS
</div>
	
<div id="values">
</div>

</body>

<script>

var set = []
var x = 0;
var y = 0;
var z = 0;
var mag = 0;
	
function handleMotionEvent(event) {

    x = event.accelerationIncludingGravity.x;
    y = event.accelerationIncludingGravity.y;
    z = event.accelerationIncludingGravity.z;
    mag = Math.sqrt((x*x) + (y*y) + (z*z))
	
    // Do something awesome.
}



window.onload = function () {



 // Check if is IOS 13 when page loads.

  if ( window.DeviceMotionEvent && typeof window.DeviceMotionEvent.requestPermission === 'function' ){

  }

}




function ClickRequestDeviceMotionEvent () {

	if (typeof DeviceMotionEvent.requestPermission === 'function') {
	  window.DeviceMotionEvent.requestPermission()

	    .then(response => {

	      if (response === 'granted') {

		window.addEventListener('devicemotion',

		  () => { document.body.innerHTML = 'DeviceMotion permissions granted.'},

		  (e) => { throw e }

	      )} else {
		console.log('DeviceMotion permissions not granted.')
	      }

	    })

	    .catch(e => {

	      console.error(e)

	    })
	}else{
		// handle regular non iOS 13+ devices
		window.addEventListener("devicemotion", handleMotionEvent, true);
	}
}

// handle regular non iOS 13+ devices
//window.addEventListener("devicemotion", handleMotionEvent, true);

window.setInterval(function(){

	 document.getElementById("values").innerHTML = "Accelerometer: "
	    + x + ", "
	    + y + ", "
	    + z + ","
			+ mag +"," + set.length;

		var onetuple = [x, y, z, mag]

		if(set.length < 50){
			set.push(onetuple);
		}
	
	}, 2000);
	
  </script>


</html>
